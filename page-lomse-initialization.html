<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lomse library. API documentation: Initializing Lomse</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="lomse.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_100x195.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lomse library. API documentation
   &#160;<span id="projectnumber">0.27.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page-lomse-initialization.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Initializing Lomse </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#page-lomse-initialization-headers">Header files to use Lomse</a></li>
<li class="level1"><a href="#page-lomse-initialization-details">Library initialization</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="page-lomse-initialization-headers"></a>
Header files to use Lomse</h1>
<p>The first step is to include the needed headers. At the time of writing this the Lomse API is not yet fixed; therefore there is not a single header file (or set of headers) to include. Instead, the headers to include will depend on the classes and functions you would like to use. Anyway, with current API you will always include:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;lomse_doorway.h&gt;</span></div><div class="line"><span class="keyword">using namespace </span>Lomse;</div></div><!-- fragment --><p><a class="el" href="classLomseDoorway.html">LomseDoorway</a> is the access point to the Lomse library and the main interface with the library. It must be used by your application at two points:</p>
<ol type="1">
<li>Before using the Lomse library it is necessary to initialize it. This means setting up certain global options about rendering and events handling.</li>
<li>Later, your application has to use it for:<ul>
<li>Opening and creating Document objects.</li>
<li>Accessing global objects and variables in Lomse library.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="page-lomse-initialization-details"></a>
Library initialization</h1>
<p>As <a class="el" href="classLomseDoorway.html">LomseDoorway</a> is the main interface with the Lomse library you should define a it, usually with global scope:</p>
<div class="fragment"><div class="line"><a class="code" href="classLomseDoorway.html">LomseDoorway</a>&amp;   m_lomse;        <span class="comment">//the Lomse library doorway</span></div></div><!-- fragment --><p>The most important aspect to consider when initializing Lomse is the format of the images to be generated. As Lomse renders music scores on a bitmap it is necessary to inform Lomse about:</p>
<ol type="1">
<li>the bitmap format to use,</li>
<li>the resolution to use (pixels per inch), and</li>
<li>the y-axis orientation.</li>
</ol>
<p>Lets start with the y-axis orientation. Lomse needs to know if your presentation device follows the standard convention used in screen displays in which the y coordinates increases downwards, that is, y-axis coordinate 0 is at top of screen and increases downwards to bottom of screen. This convention is just the opposite of the normal convention for geometry, in which 0 coordinate is at bottom of paper and increases upwards. Lomse follows the standard convention used in displays (y-axis 0 coordinate at top and increases downwards). If your application is going to display the documents on screen then the standard convention is follwed and you don't have to reverse the y-axis. Otherwise, you will have to set this parameter as necessary.</p>
<p>Also Lomse needs to know the resolution to use. If you the scores are going to be displayed on screen, you should use the appropriate screen resolution for the intended device. A value of 96ppi is typical for Linux and Windows systems. But, probably you should get this value by invoking some operating system related methods (i.e. wxDC::GetPPI() method, in wxWidgets framework).</p>
<p>The next and <b>most important</b> decision is how your application will allocate memory for the rendering buffer and the bitmap format to use, and how this bitmap will be rendered (or converted to a image format to be exported to a file or embedded in a document). Depending on your application operating system and on the application framework used for coding it, the solution is different. You should take these decissions by analyzing the most convenient and fast method for rendering the bitmaps and to avoid format conversions. Sometimes the options are very limited.</p>
<p>One you have decided on the values to use, the code to write is simple:</p>
<p>With this, we have finished Lomse initialization. Here is the full code:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> MyApp::initialize_lomse()</div><div class="line">{</div><div class="line">    <span class="comment">//the pixel format, e.g.: ARGB 32bits</span></div><div class="line">    <span class="keywordtype">int</span> pixel_format = <a class="code" href="group__enumerations.html#ggafb559e26bc610db43ba605230a142898a115170a7630e87bdb0d90728b79c1e4e">k_pix_format_argb32</a>;</div><div class="line"></div><div class="line">    <span class="comment">//the desired resolution, e.g.: 96 pixels per inch</span></div><div class="line">    <span class="keywordtype">int</span> resolution = 96;</div><div class="line"></div><div class="line">    <span class="comment">//For most systems y axis direction is 0 coordinate at top and increases</span></div><div class="line">    <span class="comment">//downwards. This is the this the assumed behaviour unless you </span></div><div class="line">    <span class="comment">// specify &#39;reverse_y_axis = true&#39;</span></div><div class="line">    <span class="keywordtype">bool</span> reverse_y_axis = <span class="keyword">false</span>;    <span class="comment">//y increases downwards</span></div><div class="line"></div><div class="line">    <span class="comment">//initialize the library with these values</span></div><div class="line">    m_lomse.<a class="code" href="classLomseDoorway.html#a01e4f12682054e5a96afa236501ac80f">init_library</a>(pixel_format, resolution, reverse_y_axis);</div><div class="line">}</div></div><!-- fragment --><dl class="section attention"><dt>Attention</dt><dd>Two important points:<ol type="1">
<li>The library must be always initialized, even if your application will not use Lomse to render scores, e.g.: uses it only for playback or other. In these cases any values for pixel format, resolution and reverse_y_axis will be valid. But your application will have to invoke the init_library() method.</li>
<li>The library can be safely re-initialized if you would like to change currently defined values.</li>
</ol>
</dd></dl>
<p>Here are some tested configurations that work (see page <a class="el" href="page-examples.html">Tutorials and samples</a> for full application code samples):</p>
<table class="doxtable">
<tr>
<th>Application framework </th><th>Operating system </th><th>Memory for the bitmap </th><th>Bitmap format </th><th>Lomse bitmap format  </th></tr>
<tr>
<td>Qt </td><td>any </td><td>a QImage object </td><td>QImage::Format_RGBA8888 </td><td>k_pix_format_rgba32 </td></tr>
<tr>
<td>wxWidgets </td><td>any </td><td>a wxImage object </td><td>RGB 24 bits per pixel </td><td>k_pix_format_rgb24 </td></tr>
<tr>
<td>JUCE </td><td>any </td><td>a juce::Image::ARGB object </td><td>ARGB, 32 bits per pixel </td><td>k_pix_format_argb32 </td></tr>
<tr>
<td>X11 </td><td>Linux </td><td>a XImage object </td><td>many suitable </td><td>many suitable </td></tr>
<tr>
<td>native Win32 API </td><td>MS Windows </td><td>a bitmap </td><td>BGRA, 32 bits per pixel </td><td>k_pix_format_bgra32 </td></tr>
<tr>
<td>JUCE </td><td>any </td><td>a juce::Image::ARGB object </td><td>ARGB, 32 bits per pixel </td><td>k_pix_format_rgba32 </td></tr>
</table>
<p>Please inform about any other configuration used by your application, for improving this documentation. Thank you. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Jan 10 2021 15:56:26 for Lomse library. API documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
