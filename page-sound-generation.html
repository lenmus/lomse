<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lomse library. API documentation: Scores playback overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="lomse.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_100x195.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lomse library. API documentation
   &#160;<span id="projectnumber">0.29.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page-sound-generation.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Scores playback overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#page-sound-generation-overview">How Lomse playback works</a></li>
<li class="level1"><a href="#page-sound-generation-summary">Your application set-up: summary</a></li>
<li class="level1"><a href="#page-sound-generation-events">How to handle sound events</a></li>
<li class="level1"><a href="#page-sound-generation-play-score">How to play an score</a></li>
<li class="level1"><a href="#page-sound-generation-tracking">Handling visual tracking events</a></li>
<li class="level1"><a href="#page-sound-generation-player-gui">The PlayerGui object</a></li>
<li class="level1"><a href="#page-sound-generation-external-player">Using an external player</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="page-sound-generation-overview"></a>
How Lomse playback works</h1>
<p>Lomse is platform independent code and cannot generate sounds for your specific platform. Therefore, Lomse implements playback by generating real-time events and sending them to your application. It is responsibility of your application to handle these events and do whatever is needed, i.e. transform sound events into real sounds or doing whatever you would like with the sound events.</p>
<p>From Lomse internal point of view, playing back an score involves, basically, two steps:</p>
<ul>
<li>The score internal model is parsed to build the sound model.</li>
<li>The sound model is then traversed and three kind of events are generated:<ol type="1">
<li>Sound events, for generating sounds.</li>
<li>Visual tracking events, for adding visual tracking effects to the displayed score during playback. For instance, highlighting notes as they are being played or displaying a vertical line at current beat position.</li>
<li>End of playback events, oriented to facilitate GUI controls synchronization and housekeeping.</li>
</ol>
</li>
</ul>
<p>It is responsibility of your application to handle these events and do whatever is necessary. But for visual effects, lose provides an implementation for generating them so, if desired, your application can delegate in lose for this task.</p>
<p>Alternatively, your application could do playback by other mechanisms (e.g., using an external player) and to provide visual feedback by synchronizing the performance with the displayed score by using Lomse methods for this. See <a class="el" href="page-sound-generation.html#page-sound-generation-external-player">Using an external player</a>.</p>
<h1><a class="anchor" id="page-sound-generation-summary"></a>
Your application set-up: summary</h1>
<p>For playing back an score your application has to:</p>
<ul>
<li>Define a class, derived from <code><a class="el" href="classMidiServerBase.html">MidiServerBase</a></code>. This class will receive the sound events and will have the responsibility for generating the sounds. See <a class="el" href="page-sound-generation.html#page-sound-generation-events">How to handle sound events</a>.</li>
<li><p class="startli">Create an instance of class <code><a class="el" href="classScorePlayer.html">ScorePlayer</a></code>. This class takes care of most of the work to do. By using it, playing an score is just two tasks:</p><ol type="1">
<li>Load the score to play in the <code><a class="el" href="classScorePlayer.html">ScorePlayer</a></code> instance.</li>
<li>Ask <code><a class="el" href="classScorePlayer.html">ScorePlayer</a></code> to play it, specifying the desired options (i.e. visual tracking, metronome settings, count-off, etc).</li>
</ol>
<p class="startli">See <a class="el" href="page-sound-generation.html#page-sound-generation-play-score">How to play an score</a>.</p>
</li>
<li>Deal with <em>visual</em> <em>tracking</em> events. All <em>visual</em> <em>tracking</em> events will be sent to the standard callback for events. For processing them, your application could delegate in Lomse by invoking method Interactor::on_visual_tracking_event(). See <a class="el" href="page-sound-generation.html#page-sound-generation-tracking">Handling visual tracking events</a>.</li>
<li>Optionally, you should create a class derived from "PlayerGui". This will allow you to link your application playback controls to lomse, so that lomse can collect current settings when needed. See <a class="el" href="page-sound-generation.html#page-sound-generation-player-gui">The PlayerGui object</a>.</li>
</ul>
<p>As you can see, implementing score playback in an application is not complex, and the only burden for your application is coding a <code>MidiServer</code> class for generating the sounds.</p>
<h1><a class="anchor" id="page-sound-generation-events"></a>
How to handle sound events</h1>
<p>For playing back an score your application has just to define a class, derived from <a class="el" href="classMidiServerBase.html">MidiServerBase</a>. This class defines the interface for processing sound events. Your application has to define a derived class (i.e. <code>MyMidiServer</code>) and implement the following virtual methods:</p>
<div class="fragment"><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> program_change(<span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a1ce6da5ff54686fbe6515581868764fd">channel</a>, <span class="keywordtype">int</span> instr) {}</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> voice_change(<span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a1ce6da5ff54686fbe6515581868764fd">channel</a>, <span class="keywordtype">int</span> instr) {}</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> note_on(<span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a1ce6da5ff54686fbe6515581868764fd">channel</a>, <span class="keywordtype">int</span> pitch, <span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a3c27aac961ab4e25e5ab9cdccf2d08e0">volume</a>) {}</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> note_off(<span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a1ce6da5ff54686fbe6515581868764fd">channel</a>, <span class="keywordtype">int</span> pitch, <span class="keywordtype">int</span> <a class="code" href="classAMidiInfo.html#a3c27aac961ab4e25e5ab9cdccf2d08e0">volume</a>) {}</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> all_sounds_off() {}</div></div><!-- fragment --><p>Sound events will be sent, directly, to your <code>MyMidiServer</code> class just by invoking any of the virtual methods. Invocation of these methods is done in real time, that is, lomse will determine the exact time at which a note on / note off has to take place, and will invoke the respective method, <code>note_on()</code> or <code>note_off()</code>, at the appropriate time. This implies that your midi server implementation is only responsible for generating or stopping sounds when requested, and no time computations are needed.</p>
<p>Lomse does not impose any restriction about how to generate sounds other than low latency. Perhaps, the simpler method to generate sounds is to rely on the MIDI synthesizer of the PC sound card.</p>
<dl class="section attention"><dt>Attention</dt><dd>As playback is a real-time task, your code must return quickly. If it needs to do some significant amount of work then you must schedule this work asynchronously, for example by posting a windows message, or you should use a separate thread. Your application should not retain control for much time as this would result in freezing lomse playback thread.</dd></dl>
<h1><a class="anchor" id="page-sound-generation-play-score"></a>
How to play an score</h1>
<p>Class <a class="el" href="classScorePlayer.html">ScorePlayer</a> provides the necessary methods for controlling all playback (start, stop, pause, etc.). Your application will have to request lomse the instance of <a class="el" href="classScorePlayer.html">ScorePlayer</a> by invoking <a class="el" href="classLomseDoorway.html#a50dbce970b84945868887966a0708634">LomseDoorway::create_score_player()</a> method and passing the <code>MidiServer</code> to use:</p>
<div class="fragment"><div class="line">MyAppMidiServer* pMidi = <span class="keyword">new</span> MyAppMidiServer();</div><div class="line"><a class="code" href="classScorePlayer.html">ScorePlayer</a>* pPlayer = m_lomse-&gt;<a class="code" href="classLomseDoorway.html#a50dbce970b84945868887966a0708634">create_score_player</a>(pMidi);</div></div><!-- fragment --><p>This can be done only once if your application saves the <a class="el" href="classScorePlayer.html">ScorePlayer</a> instance in a global variable and ensures the appropriate life scope for your <code>MyAppMidiServer</code> object.</p>
<p>Once you have the <a class="el" href="classScorePlayer.html">ScorePlayer</a> instance, playback is just loading the score to play (by invoking <a class="el" href="classScorePlayer.html#a4ee554a559a4b48a40d75543529310b6">ScorePlayer::load_score()</a> method) and invoking the appropriate methods, such as <a class="el" href="classScorePlayer.html#a949fe188fdbbe0007cb91e1f8630c89f">ScorePlayer::play()</a> or <a class="el" href="classScorePlayer.html#a483c27df7c046f56517f6b610576636d">ScorePlayer::stop()</a> or <a class="el" href="classScorePlayer.html#ae619442884736eafe2734dcf0301875b">ScorePlayer::pause()</a>;</p>
<p>Method <a class="el" href="classScorePlayer.html#a4ee554a559a4b48a40d75543529310b6">ScorePlayer::load_score()</a> requires the score to play. How to get it depends on your application, but a simple way of doing it is by using the Document methods for traversing the document and accessing its components. For instance:</p>
<div class="fragment"><div class="line"><span class="comment">//get the score player you have set up for your application</span></div><div class="line"><a class="code" href="classScorePlayer.html">ScorePlayer</a>* pPlayer  = myAppGlobals-&gt;get_score_player();</div><div class="line"></div><div class="line"><span class="comment">//get the first score, load it in the player and start playback</span></div><div class="line"><span class="keywordflow">if</span> (SpInteractor spInteractor = m_pPresenter-&gt;<a class="code" href="classPresenter.html#a3542802890a4615d251a5a786cee62b5">get_interactor</a>(0).lock())</div><div class="line">{</div><div class="line">    <a class="code" href="classADocument.html">ADocument</a> doc = m_pPresenter-&gt;<a class="code" href="classPresenter.html#a70bf977c8264b4756d3f1b7a2598cae6">get_document</a>();</div><div class="line">    <a class="code" href="classAScore.html">AScore</a> score = doc.<a class="code" href="classADocument.html#a1f8af9f8c703a5c7410902e318ed6231">first_score</a>();</div><div class="line">    <span class="keywordflow">if</span> (score.<a class="code" href="classAObject.html#a8ca0e76fa665125f1e50bd1ed8dbd213">is_valid</a>())</div><div class="line">    {</div><div class="line">        <span class="comment">//load the score in the player</span></div><div class="line">        pPlayer-&gt;<a class="code" href="classScorePlayer.html#a4ee554a559a4b48a40d75543529310b6">load_score</a>(score, <span class="keyword">nullptr</span>);</div><div class="line"></div><div class="line">        <span class="comment">//optional: select desired visual tracking effect</span></div><div class="line">        spInteractor-&gt;set_visual_tracking_mode(<a class="code" href="group__enumerations.html#gga5428193fc11653b86ce227a4c89bb2b9ad4833f9050cea288dcf71cf8604cc497">k_tracking_tempo_line</a>);</div><div class="line"></div><div class="line">        <span class="comment">//get settings for playback, probably from GUI controls</span></div><div class="line">        <span class="keywordtype">bool</span> fVisualTracking = <span class="keyword">true</span>;    <span class="comment">//generate visual tracking effects</span></div><div class="line">        <span class="keywordtype">long</span> nMM = 60;                  <span class="comment">//beats per minute</span></div><div class="line"></div><div class="line">        <span class="comment">//start playback</span></div><div class="line">        pPlayer-&gt;<a class="code" href="classScorePlayer.html#a949fe188fdbbe0007cb91e1f8630c89f">play</a>(fVisualTracking, nMM, spInteractor.get());</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="page-sound-generation-tracking"></a>
Handling visual tracking events</h1>
<p>Apart from generating sound events, lomse also generates <em>visual</em> <em>tracking</em> events, that is, events to add visual tracking effects, synchronized with sound, on the displayed score.</p>
<p>For generating visual effects you have two options, either do it yourself by modifying the lomse graphical model as desired or, simpler, delegate in lomse for generating standard visual effects. Lomse offers two type of visual effects:</p>
<ul>
<li>Highlighting notes as they are being played.</li>
<li>Displaying a vertical colored tempo line across the system, positioned at current beat.</li>
</ul>
<p>The type of visual tracking event to generate is controlled by method <a class="el" href="classInteractor.html#a6f0200c891ae22c32050be6ac415c292">Interactor::set_visual_tracking_mode()</a>. Valid values for visual tracking effects are defined in enum EVisualTrackingMode. By default, if method <a class="el" href="classInteractor.html#a6f0200c891ae22c32050be6ac415c292">Interactor::set_visual_tracking_mode()</a> is not invoked, Lomse will highlight_notes and rests as they are played back. Several visual effects can be used simultaneously by combining values with the OR ('|') operator. For example:</p>
<div class="fragment"><div class="line">spInteractor-&gt;set_visual_tracking_mode(<a class="code" href="group__enumerations.html#gga5428193fc11653b86ce227a4c89bb2b9ad4833f9050cea288dcf71cf8604cc497">k_tracking_tempo_line</a> | <a class="code" href="group__enumerations.html#gga5428193fc11653b86ce227a4c89bb2b9a79da3a4bf6cc26fc683d2085e559a780">k_tracking_highlight_notes</a>);</div></div><!-- fragment --><p><em>Visual</em> <em>tracking</em> events are sent to your application via the event handling callback, that you set up at Lomse initialization. When handling a <em>visual</em> <em>tracking</em> event, if your application would like to delegate in Lomse for visual effects generation, the only thing to do is to pass the event to the interactor:</p>
<div class="fragment"><div class="line">spInteractor-&gt;handle_event(pEvent);</div></div><!-- fragment --><p>Lomse will handle the event and will send an <em>update window</em> event to your application, for updating the display.</p>
<p>Some properties of the tracking effects, such as its colour, can be customized. See method <a class="el" href="classInteractor.html#a20eaba9bb880060c9eb121566f22dc52">Interactor::get_tracking_effect()</a>. For the customizable properties see the documentation of each specific visual effect. Example: </p><div class="fragment"><div class="line"><a class="code" href="classVisualEffect.html">VisualEffect</a>* pVE = spInteractor-&gt;get_tracking_effect(<a class="code" href="group__enumerations.html#gga5428193fc11653b86ce227a4c89bb2b9ad4833f9050cea288dcf71cf8604cc497">k_tracking_tempo_line</a>);</div><div class="line"><span class="keywordflow">if</span> (pVE)</div><div class="line">{</div><div class="line">    <a class="code" href="classTempoLine.html">TempoLine</a>* pTL = <span class="keyword">static_cast&lt;</span><a class="code" href="classTempoLine.html">TempoLine</a>*<span class="keyword">&gt;</span>(pVE);</div><div class="line">    pTL-&gt;<a class="code" href="classTempoLine.html#ad6c771005a9093ade9fa0dd8ff195c92">set_color</a>(Color(255,0,0,128));     <span class="comment">//transparent red</span></div><div class="line">    pTL-&gt;<a class="code" href="classTempoLine.html#a77fec9b68721babbfece733171b5d3e7">set_width</a>(200);                    <span class="comment">//logical units: 2 mm</span></div><div class="line">}</div></div><!-- fragment --><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Advanced topic: direct modification of the graphic model.</dd></dl>
<h1><a class="anchor" id="page-sound-generation-player-gui"></a>
The PlayerGui object</h1>
<p>For controlling playback some GUI controls (buttons, menu items, etc. to trigger start, stop, pause actions, sliders or other for setting tempo speed, etc.) are normally required.</p>
<p>The simplest way for passing the value of a playback option (i.e. the tempo speed) is to pass the value directly to lomse when asking to play the score in method <a class="el" href="classScorePlayer.html#a949fe188fdbbe0007cb91e1f8630c89f">ScorePlayer::play()</a>. But this approach has a drawback: if the user changes, for instance, the tempo slider, lomse will not be informed of the change.</p>
<p>For solving these kind of problems, the solution is to link your application playback controls to lomse, so that lomse can be informed when changes take place or can collect current settings when needed. For doing this linking your application will have to define a class derived from PlayerGui (it can be your main window) and implement a few virtual methods to allow lomse to access the current values of your application playback controls:</p>
<div class="fragment"><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">int</span> get_play_mode() = 0;</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">int</span> get_metronome_mm() = 0;</div><div class="line"><span class="keyword">virtual</span> Metronome* get_metronome() = 0;</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> countoff_status() = 0;</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> metronome_status() = 0;</div><div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> on_end_of_playback() = 0;</div></div><!-- fragment --><p>The implementation of these methods is usually as simple as linking each method to the appropriate control in your application. For instance:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> MainWindow::countoff_status()</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> GetMenuBar()-&gt;IsChecked(k_menu_play_countoff);</div><div class="line">}</div></div><!-- fragment --><p>PlayerGui is also the object that will receive <em>end of playback events</em>. These are events generated by lomse for signaling the end of playback, so that your application can restore GUI controls related to playback or do other things. This event is sent <b>simultaneously</b> to your application by to mechanisms:</p><ul>
<li>Via the event handling callback, set up at Lomse initialization, and</li>
<li>by invoking method PlayerGui::on_end_of_play_back() if a PlayerGui was set when loading the score.</li>
</ul>
<p>If you look at example code in section <a class="el" href="page-sound-generation.html#page-sound-generation-play-score">How to play an score</a> (relevant lines duplicated here):</p>
<div class="fragment"><div class="line"><span class="comment">//load the score and start playback</span></div><div class="line"><span class="keywordflow">if</span> (score.<a class="code" href="classAObject.html#a8ca0e76fa665125f1e50bd1ed8dbd213">is_valid</a>())</div><div class="line">{</div><div class="line">    pPlayer-&gt;<a class="code" href="classScorePlayer.html#a4ee554a559a4b48a40d75543529310b6">load_score</a>(score, <span class="keyword">nullptr</span>);</div></div><!-- fragment --><p>the second parameter for load_score is nullptr, meaning that no PlayerGui is used. As you can deduce, the way of informing lomse of the GUI proxy to use is by passing a pointer to the PlayerGui in this method:</p>
<div class="fragment"><div class="line"><span class="comment">//get your PlayerGui object</span></div><div class="line">MyPlayerGui* pGui = ... </div><div class="line"></div><div class="line"><span class="comment">//load the score and link playback options to your MyPlayerGui object</span></div><div class="line">pPlayer-&gt;<a class="code" href="classScorePlayer.html#a4ee554a559a4b48a40d75543529310b6">load_score</a>(score, pGui);</div><div class="line"></div><div class="line"><span class="comment">//setting tempo to 0 forces lomse to use the tempo returned by your MyPlayerGui object.</span></div><div class="line"><span class="comment">//a value different from 0 forces lomse to use that tempo</span></div><div class="line">pPlayer-&gt;<a class="code" href="classScorePlayer.html#a949fe188fdbbe0007cb91e1f8630c89f">play</a>(fVisualTracking, 0, spInteractor.get());</div></div><!-- fragment --><h1><a class="anchor" id="page-sound-generation-external-player"></a>
Using an external player</h1>
<p>If your application would like to use an external player and to provide visual feedback by synchronizing the performance with the displayed score, Lomse can not do this automatically as it doesn't control the playback, but Lomse provides some methods that can help your application to achieve the sound/display synchronization.</p>
<p>For synchronizing the performance with the displayed score it would be necessary:</p><ol type="1">
<li>to synchronize the visual tracking effects with the performance, and</li>
<li>to scroll the view as playback advances.</li>
</ol>
<p>Visual tracking effects can be managed by your application by invoking <a class="el" href="classInteractor.html">Interactor</a> methods for displaying, hiding and positioning the desired visual effect. Thus the only requirement is that your application can provide the necessary information for positioning the visual effect as playback advances.</p>
<p>Probably, the most easy approach for visual tracking effects will be to use the tempo line or the tempo block, as for using them it is only required that your application can identify the location (current measure and beat, or current time position) being played back. If your application can get that information, the procedure for synchronizing the tempo line with the playback would be as follows:</p>
<ol type="1">
<li>Enable the desired visual effect. For this just invoke: <div class="fragment"><div class="line">spInteractor-&gt;set_visual_tracking_mode(<a class="code" href="group__enumerations.html#gga5428193fc11653b86ce227a4c89bb2b9ad4833f9050cea288dcf71cf8604cc497">k_tracking_tempo_line</a>);</div></div><!-- fragment --> This can be done at any moment before playback. So perhaps the best time to do it is when the View is created or when the <code>Play</code> button is clicked.</li>
<li>Once the playback has started your application has to take care of advancing the tempo line each time a new beat is going to be played back and of doing scroll if necessary: <div class="fragment"><div class="line"><span class="keywordtype">int</span> measure =  ...  <span class="comment">//0..n</span></div><div class="line"><span class="keywordtype">int</span> beat = ... <span class="comment">//relative to measure. First beat is beat #0</span></div><div class="line">spInteractor-&gt;move_tempo_line_and_scroll_if_necessary(scoreId, measure, beat);</div></div><!-- fragment --></li>
</ol>
<p>The above method will do scroll only when Lomse determines it is necessary. If you would like to use your own algorithms for scrolling, then, instead of using <code>move_tempo_line_and_scroll_if_necessary()</code>, you should use <code>move_tempo_line()</code> and to invoke <code>scroll_to_measure()</code> when your application considers this convenient: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> measure =  ...  <span class="comment">//0..n</span></div><div class="line"><span class="keywordtype">int</span> beat = ... <span class="comment">//relative to measure. First beat is beat #0</span></div><div class="line">spInteractor-&gt;move_tempo_line(scoreId, measure, beat);</div><div class="line"><span class="keywordflow">if</span> (scroll_is_necessary())</div><div class="line">    spInteractor-&gt;scroll_to_measure(scoreId, measure, beat);</div></div><!-- fragment --><ol type="1">
<li>Finally, when playback is stopped or has finished it is necessary to ensure that any displayed visual effect is removed: <div class="fragment"><div class="line">spInteractor-&gt;remove_all_visual_tracking();</div></div><!-- fragment --></li>
</ol>
<p>And that's all. You can see a working example in examples/samples/extplayer.</p>
<p>Trying to highlight/unhighlight the notes and rests as playback advances would be too complex as this would require that your application could provide a pointer to the note/rest being played back and to detect when it has to be unhighlighted. But the approach will be similar. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Overview</a></li>
    <li class="footer">Generated on Fri Mar 18 2022 10:45:30 for Lomse library. API documentation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
